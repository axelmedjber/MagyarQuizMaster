{% extends 'layout.html' %}

{% block title %}Résultats - {{ result.quiz_name }}{% endblock %}

{% block content %}
<div class="row py-4">
    <div class="col-md-8 mx-auto">
        <div class="card mb-4">
            <div class="card-header">
                <h2 class="mb-0">{{ result.quiz_name }} - Résultats</h2>
            </div>
            <div class="card-body">
                <div class="score-display">
                    <h3>Eredmény: <span class="{% if result.score >= result.max_score * 0.7 %}text-success{% elif result.score >= result.max_score * 0.4 %}text-warning{% else %}text-danger{% endif %}">{{ result.score }}/{{ result.max_score }}</span> pont</h3>
                    
                    {% set percentage = (result.score / result.max_score) * 100 %}
                    <div class="progress mt-3 mb-4">
                        <div class="progress-bar 
                                {% if percentage >= 70 %}bg-success
                                {% elif percentage >= 40 %}bg-warning
                                {% else %}bg-danger
                                {% endif %}" 
                            role="progressbar" 
                            style="width: {{ percentage }}%" 
                            aria-valuenow="{{ percentage }}" 
                            aria-valuemin="0" 
                            aria-valuemax="100">
                            {{ percentage|round|int }}%
                        </div>
                    </div>
                    
                    {% if percentage >= 70 %}
                        <div class="alert alert-success" role="alert">
                            <i class="fas fa-trophy me-2"></i> Bravo ! Vous avez très bien réussi ce quiz !
                        </div>
                    {% elif percentage >= 40 %}
                        <div class="alert alert-warning" role="alert">
                            <i class="fas fa-thumbs-up me-2"></i> Pas mal ! Mais vous pouvez encore vous améliorer.
                        </div>
                    {% else %}
                        <div class="alert alert-danger" role="alert">
                            <i class="fas fa-book-reader me-2"></i> Vous devriez réviser davantage ce thème.
                        </div>
                    {% endif %}
                </div>
                
                <h4 class="mb-3 mt-4">Réponses détaillées :</h4>
                
                <div class="result-container">
                    {% for answer in result.answers %}
                        <div class="answer-item {% if answer.correct %}correct-answer{% else %}wrong-answer{% endif %}">
                            <p class="fw-bold mb-2">{{ loop.index }}. {{ answer.question }}</p>
                            
                            <p>
                                <span class="fw-bold">Votre réponse :</span> 
                                {% if answer.correct %}
                                    <span class="text-success"><i class="fas fa-check-circle me-1"></i>{{ answer.user_answer }}</span>
                                {% else %}
                                    <span class="text-danger"><i class="fas fa-times-circle me-1"></i>{{ answer.user_answer }}</span>
                                {% endif %}
                            </p>
                            
                            {% if not answer.correct %}
                                <p><span class="fw-bold">Réponse correcte :</span> <span class="text-success">{{ answer.correct_answer }}</span></p>
                            {% endif %}
                            
                            <p class="explanation mt-2">
                                <i class="fas fa-info-circle me-1"></i> {{ answer.explanation }}
                            </p>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-content-between">
                    <a href="{{ url_for('quiz', quiz_name=result.quiz_name) }}" class="btn btn-outline-primary">
                        <i class="fas fa-redo me-1"></i> Recommencer ce quiz
                    </a>
                    <a href="{{ url_for('index') }}" class="btn btn-primary">
                        <i class="fas fa-home me-1"></i> Retour à l'accueil
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
